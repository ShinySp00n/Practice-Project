# Compare 1st column to other columns to find missing values

import openpyxl, pyinputplus
from openpyxl.utils import get_column_letter, column_index_from_string

columnDictionary = {}

convertFile = pyinputplus.inputStr(prompt='Enter the file you want the column to be matched:\n')
wb = openpyxl.load_workbook(convertFile)
wbMatch = openpyxl.Workbook()

# Loop through all the sheets
for sheetNum in range(0, len(wb.worksheets)):
    sheet = wb.worksheets[sheetNum]
    wbMatch.create_sheet(sheet.title, sheetNum)

    sheetMatch = wbMatch.worksheets[sheetNum]

    # Loop through each column in sheet
    for columnNumber in (1, sheet.max_column):
        columnLetter = get_column_letter(columnNumber)
        startOfColumn = columnLetter + "1"
        endOfColumn = columnLetter + str(sheet.max_row)

        columnList = []

        # Check cell value in each column
        for cellRow in sheet[startOfColumn:endOfColumn]:
            for cell in cellRow:
                if cell.value is not None:
                    columnList.append(cell.value)
        # Update dictionary with values from each column
        columnDictionary.update({columnLetter: columnList})
        columnDictionary[columnLetter].sort()

keys = []
sortResult = []
# Compare values of each column
for key in columnDictionary:
    keys.append(key)

for i in range(1, len(keys)):
    result = set(columnDictionary[keys[0]]) - set(columnDictionary[keys[i]])
    print(f"Missing values from column {i + 1} compare with column 1 is:")
    print(sorted(list(result)))
    
